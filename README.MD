# Qualiextra Back-End - API REST sÃ©curisÃ©e avec Typescript, TSOA & Prisma


## ğŸ“œ PrÃ©sentation

Ce projet est une API REST dÃ©veloppÃ©e dans le cadre dâ€™un test technique pour le poste de dÃ©veloppeur Back-End chez Qualiextra.  
Lâ€™objectif Ã©tait de crÃ©er une API robuste, sÃ©curisÃ©e et bien structurÃ©e, en utilisant TypeScript, TSOA (pour gÃ©nÃ©rer automatiquement les routes et la documentation Swagger), Prisma (pour gÃ©rer la base de donnÃ©es PostgreSQL), et JWT pour lâ€™authentification.

---

## ğŸš— Contexte & FonctionnalitÃ©s

Cette API gÃ¨re un systÃ¨me dâ€™utilisateurs avec :

- **Gestion des rÃ´les** : utilisateurs standards (`USER`) et administrateurs (`ADMIN`).
- **Inscription & Authentification** : avec hashage des mots de passe (bcrypt) et tokens JWT.
- **Validation dâ€™email** : envoi dâ€™un email avec token de vÃ©rification (via Mailtrap).  
  Un utilisateur ne peut pas se connecter tant que son email nâ€™est pas validÃ©.
- **Blocage des emails temporaires** : refus des adresses issues de domaines jetables (mailinator, temp-mailâ€¦).
- **Routes protÃ©gÃ©es** accessibles uniquement aux utilisateurs authentifiÃ©s.  
- **Swagger** intÃ©grÃ© pour la documentation interactive et les tests.

---

## ğŸ“¦ Technologies utilisÃ©es

- **TypeScript** : typage statique pour un code plus sÃ»r et lisible.  
- **TSOA** : gÃ©nÃ©ration automatique des routes Express + Swagger.  
- **Prisma** : ORM moderne pour PostgreSQL.  
- **PostgreSQL** : base de donnÃ©es relationnelle.  
- **JWT (jsonwebtoken)** : authentification sÃ©curisÃ©e par tokens.  
- **bcrypt** : sÃ©curisation des mots de passe par hashage.  
- **Mailtrap** : service de test dâ€™envoi dâ€™emails.  

---

## ğŸ”§ Installation & DÃ©marrage

### PrÃ©requis

- Node.js 
- PostgreSQL (configurÃ© et accessible)
- Un compte Mailtrap pour les emails de vÃ©rification

### Ã‰tapes

1. **Cloner le dÃ©pÃ´t**

```bash

git clone https://github.com/LorenzoPizzi/Qualiextra-test.git
cd Qualiextra-test
Installer les dÃ©pendances

npm install
Configurer les variables dâ€™environnement

----

CrÃ©er un fichier .env Ã  la racine et renseigner :

.env

DATABASE_URL="postgresql://user:password@localhost:5432/nomDeTaBase"
JWT_SECRET="unePhraseSecreteSuperSecurisee"
MAILTRAP_HOST="smtp.mailtrap.io"
MAILTRAP_PORT=2525
MAILTRAP_USER="tonUserMailtrap"
MAILTRAP_PASS="tonPasswordMailtrap"

---

GÃ©nÃ©rer les fichiers Prisma & TSOA

npx prisma generate
npm run prisma:migrate  
npm run tsoa   

---

DÃ©marrer le serveur en mode dev

npm run dev
Le serveur Ã©coute par dÃ©faut sur http://localhost:3000

---

ğŸš€ Utilisation & tests
Ouvrir la documentation Swagger interactive :
http://localhost:3000/docs

Tester les routes suivantes :

POST /auth/register : inscription (vÃ©rifie les emails jetables, envoie un mail de validation)

GET /auth/verify-email?token=xxx : valider un email

POST /auth/login : connexion (renvoie un token JWT)

GET /private : route protÃ©gÃ©e accessible uniquement aux utilisateurs connectÃ©s

/users : routes CRUD utilisateurs avec restrictions dâ€™accÃ¨s selon rÃ´le

---

ğŸ“– Architecture & Code
Controllers : dans src/controllers

AuthController.ts : inscription, vÃ©rification email, connexion

UserController.ts : gestion utilisateurs (CRUD + contrÃ´le dâ€™accÃ¨s rÃ´le)

PrivateController.ts : route privÃ©e test (exemple)

Middlewares : dans src/middlewares

authMiddleware.ts : vÃ©rification JWT et ajout de lâ€™utilisateur Ã  la requÃªte

Utils & Services :

emailUtils.ts : validation des emails jetables

tokenUtils.ts : gÃ©nÃ©ration de tokens uniques

mailService.ts : envoi des emails via Mailtrap

TSOA : gÃ©nÃ¨re automatiquement routes et documentation Swagger depuis les contrÃ´leurs annotÃ©s

ğŸ›¡ï¸ SÃ©curitÃ©
Mots de passe hashÃ©s avec bcrypt avant stockage

Jetons JWT sÃ©curisÃ©s par une clÃ© secrÃ¨te dÃ©finie dans .env

Protection des routes sensibles avec middleware JWT

Validation dâ€™email obligatoire avant connexion

Blocage des emails temporaires

---

ğŸ”„ DÃ©ploiement
Lâ€™API est prÃªte Ã  Ãªtre dÃ©ployÃ©e sur un serveur distant (Heroku, Vercel, AWS...).
Veillez Ã  :

configurer les variables dâ€™environnement sur le serveur

utiliser une base PostgreSQL accessible en production

ouvrir les ports nÃ©cessaires

mettre Ã  jour la variable BASE_PATH si besoin

---

ğŸ“ Remarques
Le code est commentÃ© pour faciliter la comprÃ©hension et la maintenance.

Swagger permet de tester facilement toutes les routes sans outils externes.

Lâ€™architecture modulaire facilite lâ€™ajout de nouvelles fonctionnalitÃ©s (ex: gestion avancÃ©e des rÃ´les).

---

ğŸ‘¨â€ğŸ’» Auteur
Lorenzo Pizzi  - DÃ©veloppeur Back-End en apprentissage.